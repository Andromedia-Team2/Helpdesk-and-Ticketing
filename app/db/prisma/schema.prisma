generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://magang:magang123$%^@db.plansys.co:5432/magang2?schema=public"
}

model client {
  id_client      Int              @id @unique(map: "client_pk") @default(autoincrement())
  id_vendor      Int?
  id_user        Int?             @unique(map: "client_id_user")
  nama_client    String           @db.VarChar(150)
  email_client   String           @db.VarChar(150)
  lokasi_client  String           @db.VarChar(150)
  nomor_client   String           @db.VarChar(15)
  users          users?           @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "fk_client_do__2_user")
  vendor         vendor?          @relation(fields: [id_vendor], references: [id_vendor], onDelete: NoAction, onUpdate: NoAction, map: "fk_client_has___admin_vendor")
  history_ticket history_ticket[]

  @@index([id_user], map: "do___fk")
  @@index([id_vendor], map: "has___fk")
}

model department {
  id_department   Int              @id @unique(map: "department_pk") @default(autoincrement())
  nama_department String           @db.VarChar(150)
  deskripsi       String           @db.VarChar(150)
  id_vendor       Int
  vendor          vendor           @relation(fields: [id_vendor], references: [id_vendor], onDelete: NoAction, onUpdate: NoAction)
  employee        employee[]
  history_ticket  history_ticket[]

  @@index([id_vendor], map: "department_id_vendor")
}

model employee {
  id_employee    Int              @id @unique(map: "employee_pk") @default(autoincrement())
  id_department  Int?
  id_user        Int?             @unique(map: "employee_id_user")
  nama_employee  String           @db.VarChar(150)
  nomor_employee String           @db.VarChar(15)
  email_employee String           @db.VarChar(150)
  shift_kerja    String           @db.VarChar(150)
  id_vendor      Int?
  department     department?      @relation(fields: [id_department], references: [id_department], onDelete: NoAction, onUpdate: NoAction, map: "fk_employee_has__department")
  users          users?           @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "fk_employee_do2_user")
  vendor         vendor?          @relation(fields: [id_vendor], references: [id_vendor], onDelete: NoAction, onUpdate: NoAction, map: "fk_employee_has____admin_vendo")
  history_ticket history_ticket[]

  @@index([id_user], map: "do_fk")
  @@index([id_vendor], map: "has____fk")
  @@index([id_department], map: "has__fk")
}

model history_ticket {
  id_history_ticket    Int           @id @unique(map: "history_ticket_id_history_ticket") @default(autoincrement())
  id_ticket            Int           @unique(map: "history_ticket_id_ticket_unique")
  id_level_ticket      Int?
  id_employee          Int?
  tanggalMasuk_ticket  String        @db.VarChar
  tanggalSolved_ticket String?       @db.VarChar
  id_status_ticket     Int
  id_department        Int?
  id_client            Int
  id_vendor            Int
  client               client        @relation(fields: [id_client], references: [id_client], onDelete: NoAction, onUpdate: NoAction)
  department           department?   @relation(fields: [id_department], references: [id_department], onDelete: NoAction, onUpdate: NoAction)
  employee             employee?     @relation(fields: [id_employee], references: [id_employee], onDelete: NoAction, onUpdate: NoAction)
  level_ticket         level_ticket? @relation(fields: [id_level_ticket], references: [id_level_ticket], onDelete: NoAction, onUpdate: NoAction)
  status_ticket        status_ticket @relation(fields: [id_status_ticket], references: [id_status_ticket], onDelete: NoAction, onUpdate: NoAction)
  ticket               ticket        @relation(fields: [id_ticket], references: [id_ticket], onDelete: NoAction, onUpdate: NoAction)
  vendor               vendor        @relation(fields: [id_vendor], references: [id_vendor], onDelete: NoAction, onUpdate: NoAction)
  percakapan           percakapan[]

  @@index([id_client], map: "history_ticket_id_client")
  @@index([id_department], map: "history_ticket_id_department")
  @@index([id_employee], map: "history_ticket_id_employee")
  @@index([id_level_ticket], map: "history_ticket_id_level_ticket")
  @@index([id_status_ticket], map: "history_ticket_id_status_ticket")
  @@index([id_ticket], map: "history_ticket_id_ticket")
  @@index([id_vendor], map: "history_ticket_id_vendor")
}

model jenis_ticket {
  id_jenis_ticket        Int      @id(map: "jenis ticket_pkey") @unique(map: "jenis_ticket_id_jenis_ticket") @default(autoincrement())
  jenis_ticket           String   @db.VarChar(100)
  id_vendor              Int
  deskripsi_jenis_ticket String   @db.VarChar(300)
  vendor                 vendor   @relation(fields: [id_vendor], references: [id_vendor], onDelete: NoAction, onUpdate: NoAction)
  ticket                 ticket[]

  @@index([id_vendor], map: "jenis_ticket_id_vendor")
}

model level_ticket {
  id_level_ticket        Int              @id @unique(map: "level_ticket_id_level_ticket") @default(autoincrement())
  level_ticket           String           @db.VarChar(100)
  deskripsi_level_ticket String?          @db.VarChar(300)
  history_ticket         history_ticket[]
}

model Notifikasi {
  id_notifikasi     Int      @id @default(autoincrement())
  open_ticket       DateTime @db.Date
  unfinished_ticket DateTime @db.Date
  closed_ticket     DateTime @db.Date
}

model percakapan {
  id_percakapan            Int            @id @unique(map: "percakapan_id_percakapan") @default(autoincrement())
  tanggal_waktu_percakapan String         @db.VarChar
  isi_percakapan           String         @db.VarChar(1000)
  attachment               String         @db.VarChar(150)
  id_history_ticket        Int
  id_user                  Int
  history_ticket           history_ticket @relation(fields: [id_history_ticket], references: [id_history_ticket], onDelete: NoAction, onUpdate: NoAction)
  users                    users          @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction)

  @@index([id_history_ticket], map: "percakapan_id_history_ticket")
  @@index([id_user], map: "percakapan_id_user")
}

model role {
  id_role   Int     @id @unique(map: "role_pk") @default(autoincrement())
  nama_role String  @db.VarChar(50)
  users     users[]
}

model status_ticket {
  id_status_ticket        Int              @id @unique(map: "status_ticket_id_status_ticket") @default(autoincrement())
  status_ticket           String           @db.VarChar(100)
  deskripsi_status_ticket String           @db.VarChar(150)
  behavior_ticket         String           @db.VarChar(100)
  history_ticket          history_ticket[]
}

model ticket {
  id_ticket        Int             @id @unique(map: "ticket_id_ticket") @default(autoincrement())
  judul_ticket     String          @db.VarChar(150)
  deskripsi_ticket String          @db.VarChar(150)
  attachment       String          @db.VarChar(150)
  id_jenis_ticket  Int
  jenis_ticket     jenis_ticket    @relation(fields: [id_jenis_ticket], references: [id_jenis_ticket], onDelete: NoAction, onUpdate: NoAction)
  history_ticket   history_ticket?

  @@index([id_jenis_ticket], map: "ticket_id_jenis_ticket")
}

model users {
  id_user    Int          @id @unique(map: "user_pk") @default(autoincrement())
  id_role    Int?
  username   String       @unique(map: "users_username") @db.VarChar(100)
  password   String       @db.VarChar(100)
  role       role?        @relation(fields: [id_role], references: [id_role], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_has_role")
  client     client?
  employee   employee?
  percakapan percakapan[]
  vendor     vendor?

  @@index([id_role], map: "has_fk")
}

model vendor {
  id_vendor      Int              @id(map: "admin_vendor_pkey") @unique(map: "admin_vendor_pk") @default(autoincrement())
  id_user        Int?             @unique(map: "vendor_id_user")
  nama_vendor    String           @db.VarChar(150)
  email_vendor   String           @db.VarChar(150)
  lokasi_vendor  String           @db.VarChar(150)
  nomor_vendor   String           @db.VarChar(15)
  users          users?           @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "fk_admin_vendor_do_2_user")
  client         client[]
  department     department[]
  employee       employee[]
  history_ticket history_ticket[]
  jenis_ticket   jenis_ticket[]

  @@index([id_user], map: "do__fk")
}
