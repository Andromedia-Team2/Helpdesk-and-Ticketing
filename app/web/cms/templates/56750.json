{"title":"ticket-report","type":"cms-template","lang":"","status":"SYSTEM","parent_id":"66283","content":{"type":"API","structure":"","server_on_load":"async ({\n  template,\n  params,\n  render,\n  db,\n  req,\n  reply,\n  user,\n  log,\n  ext,\n  isDev,\n}: Server) => {\n  const { date } = req.body;\n  var mValue = [];\n\n  var tahun = 0;\n\n  if (date === null) {\n    var myDate = new Date();\n    tahun = ext.tahun(myDate);\n  } else {\n    tahun = ext.tahun(date);\n  }\n\n  for (let i = 1; i < 13; i++) {\n    var jumlah = await db.history_ticket.count({\n      where: {\n        tahun,\n        bulan: i,\n        id_client: user.user.dataUser.id_client,\n      },\n    });\n    mValue.push(jumlah);\n  }\n\n  reply.send({\n    data: mValue,\n  })\n}","figma":{}},"slug":"/api/ticket-report","site":"*","id":"56750"}